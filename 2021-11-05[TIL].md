# ğŸ“ 2021-11-05
- ì˜¤ëŠ˜ì˜ TIL

## ğŸ–¥ AWS S3 bucket ì‚¬ìš©í•˜ê¸°, multer ëª¨ë“ˆ ì´ìš©í•˜ê¸°

- `AWSì—ì„œ S3 bucket ìƒì„±`

1. AWS ë¡œê·¸ì¸ í›„, S3 bucketì„ ìƒì„±í•©ë‹ˆë‹¤. 
(https://user-images.githubusercontent.com/59908525/140503476-32b2dc46-b57b-421a-bc61-3f699b31c713.PNG)

2. ìƒì„±í•˜ bucketì— ëŒ€í•´ì„œ public accessì¼ ìˆ˜ ìˆë„ë¡, permissionì„ ì—´ì–´ì¤˜ì•¼ í•œë‹¤.
(https://user-images.githubusercontent.com/59908525/140503680-c4382427-4423-4fd8-bed1-6ced1202bf61.PNG)

3. My Security Credentialsì— ê°€ì„œ, Access keysì— ê°€ì„œ access key IDì™€ secret access keyë¥¼ ë°œê¸‰ ë°›ëŠ”ë‹¤!
<img width="956" alt="credentials" src="https://user-images.githubusercontent.com/59908525/140503967-d3169260-5425-499e-9d06-76241c914e66.PNG">



- `Backend`
- ë¹„ë°€ë²ˆí˜¸ì— ëª¨ë“  íŠ¹ìˆ˜ë¬¸ìë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©ì„ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í• ê¹Œìš”?         
    ```const path = require('path');
       const multer = require('multer');
       const multerS3 = require('multer-s3');
       const AWS = require('aws-sdk');

       require('dotenv').config();

       const s3 = new AWS.S3({ 
         accessKeyId: process.env.S3_KEYID, 
         secretAccessKey: process.env.S3_PRIVATE_KEY,
         region: process.env.region
       });

       const upload = multer({
          storage: multerS3({
            s3: s3,
            bucket: "doggy-project-bucket",
            acl: 'public-read-write',
            key: function (req, file, cb) {
              const extension = path.extname(file.originalname);
              cb(null, Date.now().toString() + extension);
           },
          }),
        });
     module.exports = upload;
     ```       
