# 📝 2021-11-05
- 오늘의 TIL

## 🖥 AWS S3 bucket 사용하기, multer 모듈 이용하기

- `AWS에서 S3 bucket 생성`

1. AWS 로그인 후, S3 bucket을 생성합니다. 
(https://user-images.githubusercontent.com/59908525/140503476-32b2dc46-b57b-421a-bc61-3f699b31c713.PNG)

2. 생성하 bucket에 대해서 public access일 수 있도록, permission을 열어줘야 한다.
(https://user-images.githubusercontent.com/59908525/140503680-c4382427-4423-4fd8-bed1-6ced1202bf61.PNG)

3. My Security Credentials에 가서, Access keys에 가서 access key ID와 secret access key를 발급 받는다!
<img width="956" alt="credentials" src="https://user-images.githubusercontent.com/59908525/140503967-d3169260-5425-499e-9d06-76241c914e66.PNG">



- `Backend`
- 비밀번호에 모든 특수문자로 구성할 수 있도록 허용을 하려면 어떻게 할까요?         
    ```const path = require('path');
       const multer = require('multer');
       const multerS3 = require('multer-s3');
       const AWS = require('aws-sdk');

       require('dotenv').config();

       const s3 = new AWS.S3({ 
         accessKeyId: process.env.S3_KEYID, 
         secretAccessKey: process.env.S3_PRIVATE_KEY,
         region: process.env.region
       });

       const upload = multer({
          storage: multerS3({
            s3: s3,
            bucket: "doggy-project-bucket",
            acl: 'public-read-write',
            key: function (req, file, cb) {
              const extension = path.extname(file.originalname);
              cb(null, Date.now().toString() + extension);
           },
          }),
        });
     module.exports = upload;
     ```       
